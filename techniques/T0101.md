# T0101: Prefix Matching

## Metadata
| Field          | Details                                      |
|----------------|----------------------------------------------|
| Created        | March 31, 2025 10:00 UTC                    |
| Last Updated   | March 31, 2025 10:00 UTC                    |
| Contributors   | [MalasadaTech](../contributors.md#malasadatech) - Initial draft and SANS example |

## Description
Adversaries use domains with identical prefixes to mimic legitimate ones (e.g., "com-login.com" and "com-security.com"), deceiving users into interacting with malicious sites.

## Example
In November 2023, a phishing scam targeted Florida's "Sunpass" toll system (sunpass.com) using a domain with a "com-" prefix, such as "com-typopn.top" or similar, to trick users into entering payment details. This was part of a broader pattern of newly registered domains observed by the SANS Internet Storm Center.

## Detection

### External Hunt
- Use Silent Push to query for domains with shared prefixes like "com-*" or "sunpass-*" and filter by recent registration dates.
- Run a Censys search for hosts with domains matching "com-*" or "sunpass*" to identify active malicious sites.
- Leverage Validin to pivot on prefix-based domain clusters, focusing on TLDs like ".top" tied to phishing activity.

### Internal Hunt
- Query Splunk for DNS logs: `index=dns "com-*" OR "sunpass*" | stats count by domain` to spot unusual prefix patterns.
- Search Elastic for HTTP requests: `url:"com-*" OR url:"sunpass*"` to flag suspicious traffic.
- Analyze proxy logs in Splunk: `sourcetype=proxy domain="com-*" OR domain="sunpass*" | top domain` to detect user visits to prefixed domains.

## Related Examples
- [EX0001: Sunpass Phishing Scam (2023)](../../examples/EX0001.md)

## Navigation
- **Tactic**: [TA0001: Domain Name Similarity](../tactics/TA0001/main.md)
- **Matrix**: [Back to Matrix](../matrix.md)
