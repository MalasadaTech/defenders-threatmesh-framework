# P0401.003: Functional Prefix Matching

## Metadata
| Field          | Details                                      |
|----------------|----------------------------------------------|
| Created        | March 31, 2025 10:00 UTC                    |
| Last Updated   | March 31, 2025 10:00 UTC                    |
| Contributors   | [MalasadaTech](../contributors.md#malasadatech) - Initial draft |

## Description
Analysts pivot from a known domain with a functional prefix (e.g., "login-portal.com") to others with the same functional intent (e.g., "login-access.com") to uncover related adversary infrastructure.

## Example
From "update-service.com" (a known malicious domain), an analyst identifies "update-system.com" by matching the "update-" prefix, revealing additional infrastructure with similar intent.

## Detection

### External Hunt
- Query Silent Push for "update-*" domains linked to "update-service.com" by registration or hosting patterns.
- Run a Censys search for "update-*" domains tied to the same IP range or SSL certificate as "update-service.com".
- Use Validin to cluster "update-*" domains associated with "update-service.com" in threat intel feeds.

### Internal Hunt
- Search Splunk DNS logs: `index=dns "update-*" | stats count by domain` to identify functionally similar domains.
- Query Elastic HTTP logs: `url:"update-*" | stats count by url` to spot traffic to related domains.
- Analyze Splunk proxy logs: `sourcetype=proxy domain="update-*" | top domain` to detect additional "update-" hits.

## Related Examples
- [EX0001: FluBot Phishing (2022)](../examples/EX0001.md)

## Navigation
- **Parent Technique**: [P0401: Prefix Matching](P0401.md)
- **Tactic**: [PTA0004: Domain Name Similarity](../pivot-tactics/PTA0004/main.md)
- **Matrix**: [Back to Matrix](../matrix.md)
