# P0102: Shared Name Servers

## Metadata
| Field          | Details                                      |
|----------------|----------------------------------------------|
| Created        | March 31, 2025 10:00 UTC                    |
| Last Updated   | March 31, 2025 10:00 UTC                    |
| Contributors   | [MalasadaTech](../contributors.md#malasadatech) - Initial draft |

## Description
Analysts pivot from a known malicious domain to identify additional adversary infrastructure by finding domains that share the same name servers, often specified during the registration process.

## Sub-Pivots
- [P0102.001: Shared Name Server Domain](P0102.001.md)

## Example
From "okta-experian.com" (using name servers like `ns1.nicenic.net`), an analyst identifies other domains using the same name servers, such as "fake-login.com", revealing additional phishing infrastructure.

## Detection

### External Hunt
- Query Silent Push for domains using `ns1.nicenic.net` as a name server, filtering by recent registration dates.
- Use DNS tools like `dig` or WHOIS to find domains sharing name servers with "okta-experian.com".
- Leverage Validin to cluster domains by name servers, focusing on `ns1.nicenic.net`.

### Internal Hunt
- Search Splunk DNS logs for domains resolved via `ns1.nicenic.net`: `index=dns nameserver="ns1.nicenic.net" | stats count by domain`.
- Query Elastic for HTTP requests to domains tied to `ns1.nicenic.net`: `url:* AND nameserver:"ns1.nicenic.net" | stats count by url`.
- Analyze proxy logs in Splunk: `sourcetype=proxy nameserver="ns1.nicenic.net" | top domain`.

## Related Examples
- [EX0001: Silent Push to find SmartApeSG, LandUpdate808, and TA582 Infra (2024)](../examples/EX0001.md)
- [EX0005: Okta Impersonation Scam (2025)](../examples/EX0005.md)

## Navigation
- **Pivot Tactic**: [PTA0001: Registration Similarity](../pivot-tactics/PTA0001/main.md)
- **Matrix**: [Back to Matrix](../matrix.md)